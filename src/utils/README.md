# Utilities

This directory contains reusable utility scripts for S&P500 stock data analysis and processing.

## Files

### `utils.py`
General utility functions including YAML configuration reading, JSONL file handling, working directory management, and outlier removal functions.

### `data_utils.py`
Core data utility functions for loading, processing, and analyzing stock data. Provides centralized path management from `config.yaml`, data loading functions, quality scoring calculations, and common data operations used across the project.

### `yoy_analysis.py`
Performs year-over-year exploratory data analysis on S&P500 stock data. Calculates yearly metrics including returns, volatility, volume changes, and data completeness. Generates yearly summary and YoY analysis CSV files.

### `stock_ranking.py`
Ranks all S&P500 stocks by data quality score based on completeness and historical coverage. Requires `yoy_analysis_full.csv` generated by `yoy_analysis.py`. Generates ranked CSV and text files for all stocks from 2009-2025.

### `generate_visualizations.py`
Generates comprehensive visualizations from the YoY analysis data including trend charts, distribution plots, correlation heatmaps, and time series comparisons. Creates 10 publication-ready visualizations saved to `data/analysis_results/visualizations/`.

## Execution Order

Scripts must be run in the following order due to dependencies:

1. **`yoy_analysis.py`** - Run first to generate YoY analysis files
2. **`stock_ranking.py`** - Requires output from step 1
3. **`generate_visualizations.py`** - Requires output from step 1

## Usage

All scripts can be run from the `src/utils` directory:

```bash
cd src/utils
python3 yoy_analysis.py
python3 stock_ranking.py
python3 generate_visualizations.py
```

Import utility functions in other scripts:

```python
from utils.data_utils import load_stock_csv, calculate_quality_score
from utils.utils import read_yaml
```

## Configuration

Project paths and parameters are centrally managed in `src/config.yaml`. All utilities automatically load paths from this configuration file, making the codebase portable across different environments.
